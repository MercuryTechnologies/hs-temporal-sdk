<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Temporal.Workflow.Query.html"><span class="hs-identifier">Temporal.Workflow.Query</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Kind</span></span><span>
</span><span id="line-4"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-5"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Temporal.Payload.html"><span class="hs-identifier">Temporal.Payload</span></a></span><span>
</span><span id="line-6"></span><span>
</span><span id="line-7"></span><span>
</span><span id="line-8"></span><span class="annot"><span class="hs-comment">{- |
Queries are sent from a Temporal Client to a Workflow Execution. The API call is synchronous. The Query is identified at both ends by a Query name. The Workflow must have a Query handler that is developed to handle that Query and provide data that represents the state of the Workflow Execution.

Queries are strongly consistent and are guaranteed to return the most recent state.
This means that the data reflects the state of all confirmed Events that came in before the Query was sent.
An Event is considered confirmed if the call creating the Event returned success.
Events that are created while the Query is outstanding may or may not be reflected in the Workflow state the Query result is based on.

A Query can carry arguments to specify the data it is requesting. And each Workflow can expose data to multiple types of Queries.

A Query must never mutate the state of the Workflow Execution&#8212;
that is, Queries are read-only and cannot contain any blocking code.
This means, for example, that Query handling logic cannot schedule Activity Executions.

Sending Queries to completed Workflow Executions is supported, though Query reject conditions can be configured per Query
-}</span></span><span>
</span><span id="line-24"></span><span class="hs-keyword">data</span><span> </span><span id="KnownQuery"><span class="annot"><a href="Temporal.Workflow.Query.html#KnownQuery"><span class="hs-identifier hs-var">KnownQuery</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680167250"><span class="annot"><a href="#local-6989586621680167250"><span class="hs-identifier hs-type">args</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680167251"><span class="annot"><a href="#local-6989586621680167251"><span class="hs-identifier hs-type">result</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680167269"><span class="annot"><a href="#local-6989586621680167269"><span class="hs-identifier hs-type">codec</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-25"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Temporal.Payload.html#Codec"><span class="hs-identifier hs-type">Codec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167269"><span class="hs-identifier hs-type">codec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167251"><span class="hs-identifier hs-type">result</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Temporal.Payload.html#ApplyPayloads"><span class="hs-identifier hs-type">ApplyPayloads</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167269"><span class="hs-identifier hs-type">codec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167250"><span class="hs-identifier hs-type">args</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Temporal.Payload.html#GatherArgs"><span class="hs-identifier hs-type">GatherArgs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167269"><span class="hs-identifier hs-type">codec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167250"><span class="hs-identifier hs-type">args</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-26"></span><span>  </span><span id="KnownQuery"><span class="annot"><a href="Temporal.Workflow.Query.html#KnownQuery"><span class="hs-identifier hs-var">KnownQuery</span></a></span></span><span>
</span><span id="line-27"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="queryName"><span class="annot"><span class="annottext">forall (args :: [*]) result. KnownQuery args result -&gt; Text
</span><a href="Temporal.Workflow.Query.html#queryName"><span class="hs-identifier hs-var hs-var">queryName</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-28"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="queryCodec"><span class="annot"><span class="annottext">()
</span><a href="Temporal.Workflow.Query.html#queryCodec"><span class="hs-identifier hs-var hs-var">queryCodec</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621680167269"><span class="hs-identifier hs-type">codec</span></a></span><span>
</span><span id="line-29"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-30"></span><span>
</span><span id="line-31"></span><span>
</span><span id="line-32"></span><span class="hs-keyword">class</span><span> </span><span id="QueryRef"><span class="annot"><a href="Temporal.Workflow.Query.html#QueryRef"><span class="hs-identifier hs-var">QueryRef</span></a></span></span><span> </span><span id="local-6989586621680167265"><span class="annot"><a href="#local-6989586621680167265"><span class="hs-identifier hs-type">query</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-33"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="QueryArgs"><span class="annot"><a href="Temporal.Workflow.Query.html#QueryArgs"><span class="hs-identifier hs-var">QueryArgs</span></a></span></span><span> </span><span id="local-6989586621680167265"><span class="annot"><a href="#local-6989586621680167265"><span class="hs-identifier hs-type">query</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">]</span><span>
</span><span id="line-34"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="QueryResult"><span class="annot"><a href="Temporal.Workflow.Query.html#QueryResult"><span class="hs-identifier hs-var">QueryResult</span></a></span></span><span> </span><span id="local-6989586621680167265"><span class="annot"><a href="#local-6989586621680167265"><span class="hs-identifier hs-type">query</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-35"></span><span>  </span><span id="queryRef"><span class="annot"><a href="Temporal.Workflow.Query.html#queryRef"><span class="hs-identifier hs-type">queryRef</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621680167265"><span class="hs-identifier hs-type">query</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Temporal.Workflow.Query.html#KnownQuery"><span class="hs-identifier hs-type">KnownQuery</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Temporal.Workflow.Query.html#QueryArgs"><span class="hs-identifier hs-type">QueryArgs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167265"><span class="hs-identifier hs-type">query</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Temporal.Workflow.Query.html#QueryResult"><span class="hs-identifier hs-type">QueryResult</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167265"><span class="hs-identifier hs-type">query</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span>
</span><span id="line-37"></span><span>
</span><span id="line-38"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680167266"><span id="local-6989586621680167267"><span class="annot"><a href="Temporal.Workflow.Query.html#QueryRef"><span class="hs-identifier hs-type">QueryRef</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Temporal.Workflow.Query.html#KnownQuery"><span class="hs-identifier hs-type">KnownQuery</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167266"><span class="hs-identifier hs-type">args</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167267"><span class="hs-identifier hs-type">result</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-39"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="QueryArgs"><span class="annot"><a href="Temporal.Workflow.Query.html#QueryArgs"><span class="hs-identifier hs-var">QueryArgs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Temporal.Workflow.Query.html#KnownQuery"><span class="hs-identifier hs-type">KnownQuery</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167266"><span class="hs-identifier hs-type">args</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167267"><span class="hs-identifier hs-type">result</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621680167266"><span class="hs-identifier hs-type">args</span></a></span><span>
</span><span id="line-40"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="QueryResult"><span class="annot"><a href="Temporal.Workflow.Query.html#QueryResult"><span class="hs-identifier hs-var">QueryResult</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Temporal.Workflow.Query.html#KnownQuery"><span class="hs-identifier hs-type">KnownQuery</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167266"><span class="hs-identifier hs-type">args</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680167267"><span class="hs-identifier hs-type">result</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621680167267"><span class="hs-identifier hs-type">result</span></a></span><span>
</span><span id="line-41"></span><span>  </span><span id="local-6989586621680167280"><span class="annot"><span class="annottext">queryRef :: KnownQuery args result
-&gt; KnownQuery
     (QueryArgs (KnownQuery args result))
     (QueryResult (KnownQuery args result))
</span><a href="Temporal.Workflow.Query.html#queryRef"><span class="hs-identifier hs-var hs-var hs-var">queryRef</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KnownQuery args result -&gt; KnownQuery args result
KnownQuery args result
-&gt; KnownQuery
     (QueryArgs (KnownQuery args result))
     (QueryResult (KnownQuery args result))
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-42"></span></pre></body></html>